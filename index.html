<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Quiz Fluxograma - Ranking Global</title>
<style>
body{margin:16px;font-family:Arial,sans-serif;background:#1e1e2f;color:#fff}
h1{text-align:center;color:#ffeb3b;margin-bottom:20px}
#userNameDiv{text-align:center;margin-bottom:20px}
#userName{padding:8px 12px;border-radius:6px;border:none;margin-right:8px;width:200px}
button{padding:8px 12px;margin:4px;border:none;border-radius:6px;background:#2196f3;color:#fff;cursor:pointer}
button:disabled{opacity:.6;cursor:default}
.container{display:flex;justify-content:center;align-items:flex-start;gap:20px}
.flowchart{width:360px;position:relative;border-radius:8px;padding:12px;background:#2c2c3c}
.symbol{width:140px;height:60px;display:flex;align-items:center;justify-content:center;font-weight:700;border-radius:10px;color:#fff;position:relative;z-index:1;cursor:pointer;transition:0.3s}
.symbol.startend{background:#ff9800;border-radius:36px}
.symbol.input{background:#f06292;clip-path:polygon(15% 0,100% 0,85% 100%,0% 100%)}
.symbol.process{background:#42a5f5}
.symbol.decision{background:#66bb6a;clip-path:polygon(50% 0,100% 50%,50% 100%,0% 50%)}
.symbol.document{background:#ffe082;color:#000}
.symbol.database{background:#9575cd}
.symbol.subprocess{background:#ff7043;border-radius:14px}
.symbol-info{position:absolute;background:rgba(0,0,0,0.85);color:#fff;padding:10px;border-radius:8px;font-size:14px;width:220px;display:none;z-index:10;pointer-events:none;transition:opacity 0.3s;opacity:0}
.symbol-info.show{display:block;opacity:1}
#question-area{width:300px;background:rgba(0,0,0,0.55);padding:16px;border-radius:10px;position:relative;top:0;transition:all .3s ease}
.question-box{display:none;margin-bottom:16px}
.question-box p{margin-bottom:12px;font-size:16px}
.question-box .answer{display:inline-block;padding:8px 14px;margin:6px;border-radius:8px;border:none;background:#1976d2;color:#fff;cursor:pointer}
.question-box .answer:disabled{opacity:.6;cursor:default}
.feedback{margin-top:10px;font-weight:700;font-size:15px}
.final{background:linear-gradient(90deg,#263238,#37474f);padding:18px;border-radius:10px;text-align:center;margin-top:20px}
#ranking{margin-top:10px;text-align:center}
#score{font-weight:600;margin:10px 0}
.arrow{width:2px;height:50px;background:#fff;position:absolute;top:60px;left:50%;transform:translateX(-50%) scaleY(0);transform-origin:top;transition:transform .5s ease,background .3s ease,opacity .3s ease;opacity:.3}
.arrow.active{opacity:1;background:#ffeb3b;transform:translateX(-50%) scaleY(1)}
@media(max-width:800px){.container{flex-direction:column;align-items:center}.flowchart{width:90%}}
</style>
</head>
<body>

<h1>Quiz do Fluxograma</h1>

<!-- Nome do usu√°rio -->
<div id="userNameDiv">
  <input type="text" id="userName" placeholder="Digite seu nome">
  <button id="btnStartQuiz">Iniciar Quiz</button>
  <p id="nameError" style="color:red;"></p>
</div>

<div id="quizContainer" style="display:none">
  <div id="score">Pontua√ß√£o: 0</div>
  <div class="container">
    <div class="flowchart">
      <div class="step" data-id="inicio" style="top:0; left:110px"><div class="symbol startend" onmouseenter="showTooltip('inicio', event)" onmouseleave="hideTooltip()">In√≠cio</div><div class="arrow"></div></div>
      <div class="step" data-id="entrada" style="top:80px; left:110px"><div class="symbol input" onmouseenter="showTooltip('entrada', event)" onmouseleave="hideTooltip()">Entrada</div><div class="arrow"></div></div>
      <div class="step" data-id="processo" style="top:160px; left:110px"><div class="symbol process" onmouseenter="showTooltip('processo', event)" onmouseleave="hideTooltip()">Processo</div><div class="arrow"></div></div>
      <div class="step" data-id="decisao" style="top:240px; left:110px"><div class="symbol decision" onmouseenter="showTooltip('decisao', event)" onmouseleave="hideTooltip()">Decis√£o</div><div class="arrow"></div></div>
      <div class="step" data-id="documento" style="top:320px; left:110px"><div class="symbol document" onmouseenter="showTooltip('documento', event)" onmouseleave="hideTooltip()">Documento</div><div class="arrow"></div></div>
      <div class="step" data-id="db" style="top:400px; left:110px"><div class="symbol database" onmouseenter="showTooltip('db', event)" onmouseleave="hideTooltip()">Banco de Dados</div><div class="arrow"></div></div>
      <div class="step" data-id="subprocesso" style="top:480px; left:110px"><div class="symbol subprocess" onmouseenter="showTooltip('subprocesso', event)" onmouseleave="hideTooltip()">Subprocesso</div><div class="arrow"></div></div>
      <div class="step" data-id="conector" style="top:560px; left:110px"><div class="symbol process" onmouseenter="showTooltip('conector', event)" onmouseleave="hideTooltip()">Conector</div><div class="arrow"></div></div>
      <div class="step" data-id="preparacao" style="top:640px; left:110px"><div class="symbol process" onmouseenter="showTooltip('preparacao', event)" onmouseleave="hideTooltip()">Prepara√ß√£o</div><div class="arrow"></div></div>
      <div class="step" data-id="fim" style="top:720px; left:110px"><div class="symbol startend" onmouseenter="showTooltip('fim', event)" onmouseleave="hideTooltip()">Fim</div></div>
    </div>
    <div class="symbol-info" id="symbolInfo"></div>

    <div id="question-area">
      <div class="question-box" id="q1"><p>Qual s√≠mbolo representa <strong>entrada/sa√≠da</strong> de dados?</p>
        <button class="answer" onclick="checkAnswer('q1','paralelogramo', this)">Paralelogramo</button>
        <button class="answer" onclick="checkAnswer('q1','losango', this)">Losango</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q2"><p>Qual s√≠mbolo √© usado para um <strong>processo/a√ß√£o</strong>?</p>
        <button class="answer" onclick="checkAnswer('q2','retangulo', this)">Ret√¢ngulo</button>
        <button class="answer" onclick="checkAnswer('q2','circulo', this)">C√≠rculo</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q3"><p>Qual s√≠mbolo representa uma <strong>decis√£o</strong>?</p>
        <button class="answer" onclick="checkAnswer('q3','losango', this)">Losango</button>
        <button class="answer" onclick="checkAnswer('q3','elipse', this)">Elipse</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q4"><p>Qual s√≠mbolo indica um <strong>documento</strong>?</p>
        <button class="answer" onclick="checkAnswer('q4','documento', this)">Documento</button>
        <button class="answer" onclick="checkAnswer('q4','processo', this)">Processo</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q5"><p>Qual s√≠mbolo indica um <strong>banco de dados</strong>?</p>
        <button class="answer" onclick="checkAnswer('q5','cilindro', this)">Cilindro</button>
        <button class="answer" onclick="checkAnswer('q5','losango', this)">Losango</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q6"><p>Qual s√≠mbolo indica um <strong>subprocesso</strong>?</p>
        <button class="answer" onclick="checkAnswer('q6','retangulo-duplo', this)">Ret√¢ngulo duplo</button>
        <button class="answer" onclick="checkAnswer('q6','paralelogramo', this)">Paralelogramo</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q7"><p>Qual s√≠mbolo √© usado como <strong>conector</strong> para ligar partes?</p>
        <button class="answer" onclick="checkAnswer('q7','circulo', this)">C√≠rculo</button>
        <button class="answer" onclick="checkAnswer('q7','losango', this)">Losango</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box" id="q8"><p>Qual s√≠mbolo √© usado para <strong>prepara√ß√£o</strong> ou setup?</p>
        <button class="answer" onclick="checkAnswer('q8','hexagono', this)">Hex√°gono</button>
        <button class="answer" onclick="checkAnswer('q8','retangulo', this)">Ret√¢ngulo</button>
        <div class="feedback"></div>
      </div>
      <div class="question-box final" id="finalBox">
        <h3>üéâ Fim do Quiz</h3>
        <p id="finalScore"></p>
        <div id="ranking"></div>
      </div>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyDzUMFgs90Kuh0TDQ8zUT0-10bMnv1CAG8",
  authDomain: "quiz-fluxograma.firebaseapp.com",
  databaseURL: "https://quiz-fluxograma-default-rtdb.firebaseio.com",
  projectId: "quiz-fluxograma",
  storageBucket: "quiz-fluxograma.appspot.com",
  messagingSenderId: "535442125816",
  appId: "1:535442125816:web:998bdad39c50d068885c0d"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Vari√°veis do quiz
let score=0, currentStep=0, startTime, userName;
const steps=["inicio","entrada","processo","decisao","documento","db","subprocesso","conector","preparacao","fim"];
const stepQuestions={entrada:"q1",processo:"q2",decisao:"q3",documento:"q4",db:"q5",subprocesso:"q6",conector:"q7",preparacao:"q8"};
const correct={q1:"paralelogramo",q2:"retangulo",q3:"losango",q4:"documento",q5:"cilindro",q6:"retangulo-duplo",q7:"circulo",q8:"hexagono"};

// Fun√ß√µes
function updateScore(){document.getElementById("score").innerText="Pontua√ß√£o: "+score;}
function startFlow(){currentStep=0;nextStep();}
function nextStep(){
  document.querySelectorAll(".symbol").forEach(s=>s.classList.remove("highlight","correct","incorrect"));
  document.querySelectorAll(".arrow").forEach(a=>a.classList.remove("active"));
  document.querySelectorAll(".question-box").forEach(q=>q.style.display="none");
  if(currentStep>=steps.length){showFinal();return;}
  const stepId=steps[currentStep];
  const stepEl=document.querySelector(`.step[data-id='${stepId}'] .symbol`);
  const arrowEl=document.querySelector(`.step[data-id='${stepId}'] .arrow`);
  if(stepEl) stepEl.classList.add("highlight");
  if(arrowEl){arrowEl.classList.add("active");}
  if(stepQuestions[stepId]){
    const qBox=document.getElementById(stepQuestions[stepId]);
    qBox.style.display="block";
    qBox.querySelectorAll("button").forEach(b=>b.disabled=false);
    qBox.querySelector(".feedback").innerText="";
  }
  currentStep++;
}
function checkAnswer(qId,ans,btn){
  const correctAns=correct[qId];
  const qBox=document.getElementById(qId);
  qBox.querySelectorAll("button").forEach(b=>b.disabled=true);
  const feedback=qBox.querySelector(".feedback");
  const stepId=Object.keys(stepQuestions).find(k=>stepQuestions[k]===qId);
  const symbol=document.querySelector(`.step[data-id='${stepId}'] .symbol`);
  if(ans===correctAns){score++;updateScore();feedback.innerText="‚úÖ Correto!";if(symbol) symbol.classList.add("correct");}
  else{feedback.innerText="‚ùå Incorreto!";if(symbol) symbol.classList.add("incorrect");}
  setTimeout(()=>nextStep(),300);
}

// Tooltip
const tooltip=document.getElementById("symbolInfo");
function showTooltip(id,e){
  const info={
    inicio:{titulo:"In√≠cio/Fim",descricao:"Ponto inicial ou final.",exemplo:"Ex: In√≠cio do processo."},
    entrada:{titulo:"Entrada/Paralelogramo",descricao:"Entrada/sa√≠da de dados.",exemplo:"Ex: Digitar nome do usu√°rio."},
    processo:{titulo:"Processo",descricao:"A√ß√£o.",exemplo:"Ex: Calcular m√©dia."},
    decisao:{titulo:"Decis√£o",descricao:"Tomada de decis√£o.",exemplo:"Ex: Usu√°rio cadastrado?"},
    documento:{titulo:"Documento",descricao:"Documento.",exemplo:"Ex: Gerar relat√≥rio."},
    db:{titulo:"Banco de Dados",descricao:"Armazenamento.",exemplo:"Ex: Salvar usu√°rio."},
    subprocesso:{titulo:"Subprocesso",descricao:"Subprocesso.",exemplo:"Ex: Validar dados."},
    conector:{titulo:"Conector",descricao:"Liga partes do fluxograma.",exemplo:"Ex: Continuar fluxo."},
    preparacao:{titulo:"Prepara√ß√£o",descricao:"Setup.",exemplo:"Ex: Preparar sistema."},
    fim:{titulo:"Fim",descricao:"Final do processo.",exemplo:"Ex: Fim do cadastro."}
  }[id];
  tooltip.innerHTML=`<strong>${info.titulo}</strong><br>${info.descricao}<br><em>${info.exemplo}</em>`;
  const rect=e.target.getBoundingClientRect();
  tooltip.style.top=(rect.top+window.scrollY)+"px";
  tooltip.style.left=(rect.right+10+window.scrollX)+"px";
  tooltip.classList.add("show");
}
function hideTooltip(){tooltip.classList.remove("show");}

// Final
function showFinal(){
  const endTime=new Date().getTime();
  const tempo=Math.floor((endTime-startTime)/1000);
  document.getElementById("finalScore").innerText=`Sua pontua√ß√£o final: ${score}`;
  document.getElementById("finalBox").style.display="block";
  db.ref('ranking').push({nome:userName,pontuacao:score,tempo:tempo,timestamp:Date.now()});
  db.ref('ranking').once('value', snapshot => {
    if(snapshot.exists()){
      const dados = Object.values(snapshot.val())
        .sort((a,b)=>b.pontuacao-a.pontuacao)
        .slice(0,10);
      document.getElementById("ranking").innerHTML="<strong>üèÜ Ranking Top 10</strong><br>"+dados.map(d=>`${d.nome}: ${d.pontuacao}`).join("<br>");
    }
  });
}

// Iniciar quiz
document.getElementById("btnStartQuiz").addEventListener("click", ()=>{
  const input=document.getElementById("userName").value.trim();
  if(!input){document.getElementById("nameError").innerText="Digite seu nome!"; return;}
  userName=input;
  startTime=new Date().getTime();
  document.getElementById("userNameDiv").style.display="none";
  document.getElementById("quizContainer").style.display="block";
  startFlow();
});
</script>
</body>
</html>
