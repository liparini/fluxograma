<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pr√°tica de Fluxograma</title>
<style>
body { font-family: Arial, sans-serif; background:#1e1e2f; color:#fff; margin:20px; }
h1 { text-align:center; color:#ffeb3b; margin-bottom:20px; }
#topBar { text-align:center; margin-bottom:20px; }
#question-area { background:#2c2c3c; padding:16px; border-radius:10px; max-width:1000px; margin:auto; display:flex; flex-direction:column; gap:12px; }
.question-box { display:flex; justify-content:space-between; align-items:center; flex-wrap:nowrap; gap:12px; }
button { margin:0 6px; padding:10px 16px; border:none; border-radius:6px; background:#1976d2; color:#fff; cursor:pointer; font-size:16px; transition: transform 0.2s; }
button:hover { transform: scale(1.05); }
.hint-box { background:#444; padding:14px; border-radius:8px; width:50%; font-size:16px; }
.symbol-img { text-align:center; width:140px; }
.symbol-img svg { width:100%; height:auto; }
.symbol-active { filter: drop-shadow(0 0 15px #ffeb3b) brightness(1.3); transform: scale(1.15); transition: 0.5s; }
.symbol-correct { filter: drop-shadow(0 0 15px #00ff00) brightness(1.2); transform: scale(1.1); }
.symbol-wrong { filter: drop-shadow(0 0 15px #ff0000) brightness(1.2); transform: scale(1.1); }
.clearfix::after { content:""; display:block; clear:both; }
#history { background:#333; padding:10px; border-radius:8px; margin-top:20px; font-size:14px; }
#quizCount { margin-top:10px; font-weight:bold; font-size:16px; }
input { padding:10px 14px; border-radius:6px; border:none; margin-right:10px; font-size:16px; }
#btnRestart { background:#43a047; margin-top:10px; }
#exampleFlowchart { position:relative; margin:auto; max-width:1000px; min-height:800px; background:#2c2c3c; border-radius:10px; padding:20px; overflow:visible; }
.flow-node { position:absolute; text-align:center; width:140px; }
.flow-node svg { width:100%; height:auto; }
</style>
</head>
<body>

<h1>Pr√°tica de Fluxograma</h1>

<div id="topBar">
  <input type="text" id="userName" placeholder="Digite seu nome">
  <button id="btnStartQuiz">Iniciar Quiz</button>
  <div id="quizCount"></div>
</div>

<div id="question-area"></div>

<div id="finalBox" style="display:none;">
  <h3>üéâ Fim do Quiz</h3>
  <p id="finalScore"></p>
  <div id="history"></div>
  <div id="totalQuizzes"></div>
  <h4>Exemplo de Fluxograma Completo Animado:</h4>
  <div id="exampleFlowchart"></div>
  <button id="btnRestart">Reiniciar Quiz</button>
</div>

<script>
// --- S√≠mbolos ---
const symbols = {
  inicio: { nome:"In√≠cio/Fim", svg:`<svg viewBox="0 0 140 80"><ellipse cx="70" cy="40" rx="60" ry="35" fill="#ff9800" stroke="#fff" stroke-width="3"/></svg>`, hint:"Representa in√≠cio ou fim do fluxograma." },
  entrada: { nome:"Entrada/Sa√≠da", svg:`<svg viewBox="0 0 140 80"><polygon points="20,0 140,0 120,80 0,80" fill="#f06292" stroke="#fff" stroke-width="3"/></svg>`, hint:"Indica entrada ou sa√≠da de dados." },
  processo: { nome:"Processo", svg:`<svg viewBox="0 0 140 80"><rect x="5" y="5" width="130" height="70" fill="#42a5f5" stroke="#fff" stroke-width="3" rx="12"/></svg>`, hint:"Representa uma a√ß√£o ou tarefa." },
  decisao: { nome:"Decis√£o", svg:`<svg viewBox="0 0 140 80"><polygon points="70,0 140,40 70,80 0,40" fill="#66bb6a" stroke="#fff" stroke-width="3"/></svg>`, hint:"Indica decis√£o que leva a caminhos diferentes." },
  documento: { nome:"Documento", svg:`<svg viewBox="0 0 140 80"><rect x="5" y="5" width="130" height="70" fill="#ffe082" stroke="#fff" stroke-width="3"/></svg>`, hint:"Representa um documento ou relat√≥rio." },
  db: { nome:"Banco de Dados", svg:`<svg viewBox="0 0 140 80"><ellipse cx="70" cy="10" rx="60" ry="12" fill="#9575cd" stroke="#fff" stroke-width="2"/><rect x="10" y="10" width="120" height="60" fill="#7e57c2" stroke="#fff" stroke-width="2"/><ellipse cx="70" cy="70" rx="60" ry="12" fill="#9575cd" stroke="#fff" stroke-width="2"/></svg>`, hint:"Representa um banco de dados." },
  subprocesso: { nome:"Subprocesso", svg:`<svg viewBox="0 0 140 80"><rect x="5" y="5" width="130" height="70" fill="#ff7043" stroke="#fff" stroke-width="3" rx="10"/><rect x="15" y="15" width="110" height="50" fill="none" stroke="#fff" stroke-width="3"/></svg>`, hint:"Indica um subprocesso definido externamente." },
  conector: { nome:"Conector", svg:`<svg viewBox="0 0 80 80"><circle cx="40" cy="40" r="35" fill="#9ccc65" stroke="#fff" stroke-width="3"/></svg>`, hint:"Usado para conectar partes do fluxograma." },
  preparacao: { nome:"Prepara√ß√£o", svg:`<svg viewBox="0 0 140 80"><polygon points="35,0 105,0 140,40 105,80 35,80 0,40" fill="#26c6da" stroke="#fff" stroke-width="3"/></svg>`, hint:"Indica prepara√ß√£o ou configura√ß√£o antes de um processo." }
};

// --- Perguntas (2 por s√≠mbolo) ---
const questions = [
  {symbol:"inicio", text:"Qual s√≠mbolo indica o in√≠cio do fluxograma?", options:["Elipse","Ret√¢ngulo","Losango"], answer:"Elipse"},
  {symbol:"inicio", text:"Qual s√≠mbolo tamb√©m representa o fim do fluxograma?", options:["Elipse","Paralelogramo","Ret√¢ngulo"], answer:"Elipse"},
  {symbol:"entrada", text:"Qual s√≠mbolo indica entrada de dados?", options:["Paralelogramo","Ret√¢ngulo","Elipse"], answer:"Paralelogramo"},
  {symbol:"entrada", text:"Qual s√≠mbolo tamb√©m representa sa√≠da de informa√ß√µes?", options:["Losango","Paralelogramo","Ret√¢ngulo"], answer:"Paralelogramo"},
  {symbol:"processo", text:"Qual s√≠mbolo representa uma a√ß√£o ou tarefa?", options:["Ret√¢ngulo","Losango","Elipse"], answer:"Ret√¢ngulo"},
  {symbol:"processo", text:"Em qual s√≠mbolo descrevemos uma etapa do processo?", options:["Paralelogramo","Ret√¢ngulo","Losango"], answer:"Ret√¢ngulo"},
  {symbol:"decisao", text:"Qual s√≠mbolo indica um ponto de decis√£o?", options:["Losango","Ret√¢ngulo","Elipse"], answer:"Losango"},
  {symbol:"decisao", text:"Qual s√≠mbolo √© usado quando o fluxo pode seguir por caminhos diferentes?", options:["Losango","Paralelogramo","Ret√¢ngulo"], answer:"Losango"},
  {symbol:"documento", text:"Qual s√≠mbolo representa um documento ou relat√≥rio?", options:["Documento","Ret√¢ngulo","Losango"], answer:"Documento"},
  {symbol:"documento", text:"Qual s√≠mbolo √© usado para mostrar relat√≥rios em fluxograma?", options:["Documento","Paralelogramo","Elipse"], answer:"Documento"},
  {symbol:"db", text:"Qual s√≠mbolo representa um banco de dados?", options:["Cilindro","Losango","Ret√¢ngulo"], answer:"Cilindro"},
  {symbol:"db", text:"Qual s√≠mbolo indica armazenamento de dados?", options:["Cilindro","Paralelogramo","Elipse"], answer:"Cilindro"},
  {symbol:"subprocesso", text:"Qual s√≠mbolo indica um subprocesso definido?", options:["Subprocesso","Ret√¢ngulo","Losango"], answer:"Subprocesso"},
  {symbol:"subprocesso", text:"Qual s√≠mbolo √© usado para etapas externas do processo?", options:["Subprocesso","Paralelogramo","Elipse"], answer:"Subprocesso"},
  {symbol:"conector", text:"Qual s√≠mbolo conecta partes do fluxograma?", options:["Conector","Losango","Ret√¢ngulo"], answer:"Conector"},
  {symbol:"conector", text:"Qual s√≠mbolo √© usado para liga√ß√µes entre fluxos?", options:["Conector","Paralelogramo","Elipse"], answer:"Conector"},
  {symbol:"preparacao", text:"Qual s√≠mbolo representa prepara√ß√£o?", options:["Prepara√ß√£o","Losango","Ret√¢ngulo"], answer:"Prepara√ß√£o"},
  {symbol:"preparacao", text:"Qual s√≠mbolo indica configura√ß√£o antes do processo?", options:["Prepara√ß√£o","Paralelogramo","Elipse"], answer:"Prepara√ß√£o"}
];

// --- Vari√°veis ---
let currentQuestion=0, correct=0, history=[], totalQuizzes=0, currentUser="", userAnswers={};

// --- Fun√ß√µes ---
function initUser(){
  const name=document.getElementById("userName").value.trim();
  if(!name){ alert("Digite seu nome"); return false; }
  if(currentUser!==name){
    currentUser=name; userAnswers={};
    totalQuizzes=parseInt(localStorage.getItem("quizCount_"+currentUser))||0;
  }
  document.getElementById("quizCount").textContent=`Voc√™ realizou o quiz ${totalQuizzes} vezes.`;
  return true;
}

// Iniciar quiz
document.getElementById("btnStartQuiz").addEventListener("click",()=>{
  if(!initUser()) return;
  document.getElementById("question-area").innerHTML="";
  currentQuestion=0; correct=0; history=[];
  document.getElementById("finalBox").style.display="none";
  showQuestion();
});

// Mostrar pergunta
function showQuestion(){
  if(currentQuestion>=questions.length){ endQuiz(); return; }
  const q=questions[currentQuestion];
  const qBox=document.createElement("div"); qBox.className="question-box clearfix";

  const left=document.createElement("div"); left.className="symbol-img"; left.innerHTML=symbols[q.symbol].svg;
  const right=document.createElement("div"); right.className="hint-box"; right.innerHTML=`${q.text} <em>Dica: ${symbols[q.symbol].hint}</em>`;

  qBox.appendChild(left); qBox.appendChild(right);

  const opts=[...q.options].sort(()=>Math.random()-0.5);
  const btnDiv=document.createElement("div"); btnDiv.style.display="flex"; btnDiv.style.gap="8px";
  opts.forEach(opt=>{
    const btn=document.createElement("button");
    btn.textContent=opt; btn.onclick=()=>checkAnswer(opt,q.symbol,qBox);
    btnDiv.appendChild(btn);
  });
  qBox.appendChild(btnDiv);

  document.getElementById("question-area").appendChild(qBox);
}

// Validar resposta
function checkAnswer(opt,symbol,qBox){
  const q=questions[currentQuestion];
  let resultSymbol="";
  if(opt===q.answer){
    correct++; resultSymbol="‚úÖ"; qBox.querySelector(".symbol-img").classList.add("symbol-correct"); userAnswers[symbol]="correct";
  } else {
    resultSymbol="‚ùå"; qBox.querySelector(".symbol-img").classList.add("symbol-wrong"); userAnswers[symbol]="wrong";
  }
  history.push({q:q.text, answer:opt, result:resultSymbol});
  currentQuestion++;
  setTimeout(()=>{ document.getElementById("question-area").innerHTML=""; showQuestion(); },600);
}

// Finalizar quiz
function endQuiz(){
  totalQuizzes++; localStorage.setItem("quizCount_"+currentUser,totalQuizzes);
  document.getElementById("quizCount").textContent=`Voc√™ realizou o quiz ${totalQuizzes} vezes.`;
  document.getElementById("finalBox").style.display="block";
  document.getElementById("finalScore").textContent=`${currentUser}, voc√™ acertou ${correct} de ${questions.length} perguntas.`;

  let histHTML="";
  history.forEach(h=>{ histHTML+=`${h.q} - Resposta: ${h.answer} ${h.result}<br>`; });
  document.getElementById("history").innerHTML=histHTML;
  document.getElementById("totalQuizzes").textContent=`Total de quizzes realizados: ${totalQuizzes}`;

  drawExampleFlowchartAnimatedContinuous();
}

// Reiniciar quiz
document.getElementById("btnRestart").addEventListener("click",()=>{
  document.getElementById("finalBox").style.display="none";
  document.getElementById("question-area").innerHTML="";
  currentQuestion=0; correct=0; history=[]; userAnswers={};
  showQuestion();
});

// --- Fluxograma animado cont√≠nuo ---
function drawExampleFlowchartAnimatedContinuous(){
  const container=document.getElementById("exampleFlowchart");
  container.innerHTML="";

  const nodes=[
    {id:"inicio",x:400,y:20,sym:"inicio"},
    {id:"entrada",x:400,y:120,sym:"entrada"},
    {id:"processo",x:400,y:220,sym:"processo"},
    {id:"decisao",x:400,y:320,sym:"decisao"},
    {id:"processoSim",x:250,y:420,sym:"processo"},
    {id:"processoNao",x:550,y:420,sym:"processo"},
    {id:"documento",x:400,y:520,sym:"documento"},
    {id:"db",x:400,y:620,sym:"db"},
    {id:"fim",x:400,y:720,sym:"inicio"}
  ];

  const arrows=[
    {from:"inicio",to:"entrada",curve:0,color:"#fff"},
    {from:"entrada",to:"processo",curve:0,color:"#fff"},
    {from:"processo",to:"decisao",curve:0,color:"#fff"},
    {from:"decisao",to:"processoSim",curve:-0.5,color:"#00ff00"},
    {from:"decisao",to:"processoNao",curve:0.5,color:"#ff5252"},
    {from:"processoSim",to:"documento",curve:0,color:"#00ff00"},
    {from:"processoNao",to:"documento",curve:0,color:"#ff5252"},
    {from:"documento",to:"db",curve:0,color:"#fff"},
    {from:"db",to:"fim",curve:0,color:"#fff"}
  ];

  nodes.forEach(n=>{
    const div=document.createElement("div"); div.className="flow-node"; div.style.left=n.x+"px"; div.style.top=n.y+"px";
    div.innerHTML=`${symbols[n.sym].svg}<br>${symbols[n.sym].nome}`;
    container.appendChild(div);
    n.elem=div;
  });

  const svgPath=document.createElementNS("http://www.w3.org/2000/svg","svg");
  svgPath.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%;overflow:visible;");
  svgPath.innerHTML=`<defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0,10 3.5,0 7" fill="#fff"/></marker></defs>`;
  container.appendChild(svgPath);

  function animateFlow(){
    let step=0;
    function nextStep(){
      svgPath.innerHTML=`<defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0,10 3.5,0 7" fill="#fff"/></marker></defs>`;
      nodes.forEach(n=>n.elem.classList.remove("symbol-active"));
      function animateArrow(i){
        if(i>=arrows.length){ setTimeout(animateFlow,500); return; }
        const a=arrows[i];
        const fromNode=nodes.find(n=>n.id===a.from);
        const toNode=nodes.find(n=>n.id===a.to);
        fromNode.elem.classList.add("symbol-active");
        const x1=fromNode.x+70, y1=fromNode.y+40, x2=toNode.x+70, y2=toNode.y+40;
        const curveX=(x1+x2)/2, curveY=(y1+y2)/2 + 80*a.curve;
        const pathEl=document.createElementNS("http://www.w3.org/2000/svg","path");
        pathEl.setAttribute("d",`M${x1},${y1} Q${curveX},${curveY} ${x2},${y2}`);
        pathEl.setAttribute("stroke",a.color); pathEl.setAttribute("stroke-width","3");
        pathEl.setAttribute("fill","transparent"); pathEl.setAttribute("marker-end","url(#arrowhead)");
        svgPath.appendChild(pathEl);
        setTimeout(()=>animateArrow(i+1),600);
      }
      animateArrow(0);
    }
    nextStep();
  }
  animateFlow();
}

</script>
</body>
</html>
